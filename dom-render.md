# dom 渲染过程

1. 获取 DOM 并将其分割为多个层（layer）
2. 将每个层独立地绘制进位图（bitmap）中
3. 将层作为纹理（texture）上传至 GPU
4. 复合（composite）多个层来生成最终的屏幕图像。

## 创建复合层条件

- 3D 或透视变换 CSS 属性
- 使用加速视频解码的 <video> 元素
- 拥有 3D (WebGL) 上下文或加速的 2D 上下文的 <canvas> 元素
- 复合插件(如 Flash)
- 进行 opacity/transform 动画的元素
- 拥有加速 CSS filters 的元素
- 元素有一个包含复合层的后代节点(换句话说，就是一个元素拥有一个子元素，该子元素在自己的层里)
- 元素有一个 z-index 较低且包含一个复合层的兄弟元素(换句话说就是该元素在复合层上面渲染)

使用 transform 来控制不适用 left，right 来控制动画原因，是因为 left，right 会触发 repaint， 让浏览器重绘。大大消耗浏览器性能。使用 transform 动画元素会创建一个复合层，只要该层内容没有发生改变，浏览器就不会重绘，同时只需要重新复合形成下一个渲染帧。

1. 对布局属性进行动画，浏览器需要为每一帧进行重绘并上传到 GPU 中
2. 对合成属性进行动画，浏览器会为元素创建一个独立的复合层，当元素内容没有发生改变，该层就不会被重绘，浏览器会通过重新复合来创建动画帧
